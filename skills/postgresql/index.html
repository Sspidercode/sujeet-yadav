<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Skill - PostgreSQL | Sujeet Yadav</title>
  <meta name="description" content="PostgreSQL skill details, intro and comprehensive concepts with examples" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="../../assets/css/style.css" rel="stylesheet" />
  <style>
    .concept-section {
      margin-bottom: 2rem;
    }

    .code-example {
      background: #0b0d12;
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 6px;
      padding: 12px;
      white-space: pre;
      overflow: auto;
      font-size: 0.875rem;
    }

    .explanation {
      margin-bottom: 1rem;
    }
  </style>
</head>

<body class="theme-dark">
  <canvas id="smokeCanvas"></canvas>
  <nav class="navbar navbar-dark nav-v2" style="position: sticky; top: 0; z-index: 10;">
    <div class="container py-2">
      <a class="navbar-brand fw-bold brand-v2 signature-font" href="../../index.html#skills"><img class="brand-logo" src="../../assets/image/sujeet.png" alt="Sujeet Yadav" /></a>
      <a class="btn btn-outline-v2 btn-sm" href="../../index.html#skills">Back to Skills</a>
    </div>
  </nav>
  <main class="section pt-6">
    <div class="container">
      <p class="eyebrow-v2">Skill</p>
      <h1 class="title-v2 mb-2">PostgreSQL</h1>
      <p class="text-muted-2 small mb-4">Advanced relational database with powerful features (CTEs, JSONB, window
        functions). Below is a comprehensive guide to key PostgreSQL concepts with detailed explanations and examples.
        (Examples use SQL; run in psql or pgAdmin. Assumes PostgreSQL 16+.)</p>

      <div class="row g-4 align-items-start">
        <div class="col-lg-4 text-center">
          <img src="icon.svg" alt="PostgreSQL icon" style="width:220px;height:220px;" />
        </div>
        <div class="col-lg-8">
          <!-- Basic Example -->
          <div class="panel-v2 concept-section">
            <h5 class="mb-2">Basic Example: Version Check</h5>
            <div class="explanation">
              <p>This query returns the PostgreSQL server version, useful for compatibility checks in scripts or
                connections.</p>
            </div>
            <pre class="code-example"><code>SELECT version();</code></pre>
            <a href="example.txt" class="btn btn-outline-v2 btn-sm mt-2" target="_blank">Open example.txt</a>
          </div>
        </div>
      </div>
      <div class="row g-4 align-items-center">
        <!-- Concept 1: Database Creation and Management -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">1. Database Creation and Management</h5>
          <div class="explanation">
            <p>Create/drop databases with encoding (UTF8). Manage roles/users with GRANT/REVOKE. Use \l in psql for
              listing.</p>
          </div>
          <pre class="code-example"><code>-- Create database
          CREATE DATABASE sujeet_portfolio ENCODING 'UTF8' LC_COLLATE 'en_US.UTF-8' LC_CTYPE 'en_US.UTF-8' TEMPLATE template0;
          
          -- Connect: \c sujeet_portfolio
          
          -- Create role/user
          CREATE ROLE sujeet WITH LOGIN PASSWORD 'secure_pass';
          GRANT ALL PRIVILEGES ON DATABASE sujeet_portfolio TO sujeet;
          
          -- Drop
          DROP DATABASE IF EXISTS old_db;
          DROP ROLE old_role;</code></pre>
        </div>

        <!-- Concept 2: Tables and Data Types -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">2. Tables and Data Types</h5>
          <div class="explanation">
            <p>Tables with rich types: SERIAL for auto-increment, TEXT, JSONB, UUID, INTERVAL. Use GENERATED for
              computed columns.</p>
          </div>
          <pre class="code-example"><code>-- Create table
          CREATE TABLE users (
              id SERIAL PRIMARY KEY,
              name TEXT NOT NULL,
              email TEXT UNIQUE NOT NULL,
              age INTEGER CHECK (age >= 18),
              created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
              data JSONB DEFAULT '{}'::JSONB,
              role TEXT GENERATED ALWAYS AS (CASE WHEN age > 30 THEN 'senior' ELSE 'junior' END) STORED
          );
          
          -- Insert
          INSERT INTO users (name, email, age, data) VALUES 
          ('Sujeet Yadav', 'sujeet@example.com', 30, '{"skills": ["PHP", "PostgreSQL"]}');</code></pre>
        </div>

        <!-- Concept 3: CRUD Operations -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">3. CRUD Operations</h5>
          <div class="explanation">
            <p>INSERT, SELECT, UPDATE, DELETE. Use RETURNING for immediate results; ON CONFLICT for upserts.</p>
          </div>
          <pre class="code-example"><code>-- Create
          INSERT INTO users (name, email, age) VALUES ('Alice', 'alice@example.com', 25) RETURNING id;
          
          -- Read
          SELECT * FROM users WHERE age > 25 ORDER BY created_at DESC LIMIT 10;
          
          -- Update
          UPDATE users SET age = 31 WHERE email = 'sujeet@example.com' RETURNING *;
          
          -- Delete
          DELETE FROM users WHERE id = 1 RETURNING *;
          
          -- Upsert
          INSERT INTO users (email, name) VALUES ('bob@example.com', 'Bob') 
          ON CONFLICT (email) DO UPDATE SET name = EXCLUDED.name;</code></pre>
        </div>

        <!-- Concept 4: Advanced Queries and JOINs -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">4. Advanced Queries and JOINs</h5>
          <div class="explanation">
            <p>JOIN types (INNER, LEFT); aggregate functions (COUNT, AVG). Subqueries and EXISTS for complex logic.</p>
          </div>
          <pre class="code-example"><code>-- Create posts table
          CREATE TABLE posts (
              id SERIAL PRIMARY KEY,
              user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
              title TEXT
          );
          
          -- JOIN with aggregate
          SELECT u.name, COUNT(p.id) as post_count
          FROM users u
          LEFT JOIN posts p ON u.id = p.user_id
          GROUP BY u.id, u.name
          HAVING COUNT(p.id) > 0
          ORDER BY post_count DESC;
          
          -- Subquery
          SELECT name FROM users WHERE id IN (SELECT user_id FROM posts WHERE title ILIKE '%PHP%');
          
          -- EXISTS
          SELECT name FROM users u WHERE EXISTS (SELECT 1 FROM posts p WHERE p.user_id = u.id);</code></pre>
        </div>

        <!-- Concept 5: Indexing -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">5. Indexing</h5>
          <div class="explanation">
            <p>B-tree default; GIN for JSONB/full-text, BRIN for time-series. Partial indexes for conditional. Analyze
              with EXPLAIN.</p>
          </div>
          <pre class="code-example"><code>-- B-tree index
          CREATE INDEX idx_users_email ON users (email);
          
          -- GIN for JSONB
          CREATE INDEX idx_users_data ON users USING GIN (data);
          
          -- Partial index
          CREATE INDEX idx_active_users ON users (age) WHERE age > 25;
          
          -- Full-text
          CREATE INDEX idx_posts_fts ON posts USING GIN (to_tsvector('english', title));
          
          -- Explain
          EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'sujeet@example.com';</code></pre>
        </div>

        <!-- Concept 6: Constraints and Relationships -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">6. Constraints and Relationships</h5>
          <div class="explanation">
            <p>FOREIGN KEY, UNIQUE, CHECK, EXCLUDE. Supports 1:1, 1:M, M:N with array or junction tables.</p>
          </div>
          <pre class="code-example"><code>-- Table with constraints
          CREATE TABLE orders (
              id SERIAL PRIMARY KEY,
              user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE,
              total NUMERIC(10,2) CHECK (total >= 0),
              UNIQUE (user_id, created_at)
          );
          
          -- Exclusion constraint (e.g., no overlapping events)
          CREATE TABLE events (
              id SERIAL PRIMARY KEY,
              room TEXT,
              start_time TIMESTAMP,
              end_time TIMESTAMP,
              EXCLUDE USING gist (
                  room WITH =,
                  tsrange(start_time, end_time) WITH &&
              )
          );</code></pre>
        </div>

        <!-- Concept 7: Transactions and Locking -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">7. Transactions and Locking</h5>
          <div class="explanation">
            <p>BEGIN/COMMIT/ROLLBACK for ACID. Isolation levels (SERIALIZABLE); SAVEPOINT for nested.</p>
          </div>
          <pre class="code-example"><code>BEGIN;
          
          INSERT INTO users (name, email) VALUES ('Charlie', 'charlie@example.com');
          UPDATE posts SET title = 'Updated' WHERE user_id = currval('users_id_seq');
          
          -- SAVEPOINT
          SAVEPOINT my_savepoint;
          DELETE FROM users WHERE id = currval('users_id_seq');
          ROLLBACK TO SAVEPOINT my_savepoint;
          
          COMMIT;
          
          -- Isolation
          SET SESSION CHARACTERISTICS AS TRANSACTION ISOLATION LEVEL SERIALIZABLE;</code></pre>
        </div>

        <!-- Concept 8: Window Functions -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">8. Window Functions</h5>
          <div class="explanation">
            <p>ROW_NUMBER, RANK, LAG/LEAD for analytics. PARTITION BY for grouping without aggregation.</p>
          </div>
          <pre class="code-example"><code>-- Insert sample posts
          INSERT INTO posts (user_id, title) VALUES (1, 'Post 1'), (1, 'Post 2'), (2, 'Post A');
          
          -- Window functions
          SELECT 
              u.name,
              p.title,
              ROW_NUMBER() OVER (PARTITION BY u.id ORDER BY p.created_at DESC) as rn,
              RANK() OVER (ORDER BY COUNT(p.id) DESC) as user_rank,
              LAG(p.title) OVER (PARTITION BY u.id ORDER BY p.id) as prev_title
          FROM users u
          JOIN posts p ON u.id = p.user_id
          GROUP BY u.id, u.name, p.title, p.id, p.created_at
          ORDER BY u.name, rn;</code></pre>
        </div>

        <!-- Concept 9: Common Table Expressions (CTEs) -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">9. Common Table Expressions (CTEs)</h5>
          <div class="explanation">
            <p>WITH for recursive/subqueries; improves readability. Recursive CTEs for hierarchies.</p>
          </div>
          <pre class="code-example"><code>-- Simple CTE
          WITH active_users AS (
              SELECT * FROM users WHERE age > 25
          )
          SELECT au.name, COUNT(p.id) FROM active_users au
          JOIN posts p ON au.id = p.user_id
          GROUP BY au.id, au.name;
          
          -- Recursive CTE (e.g., employee hierarchy)
          WITH RECURSIVE emp_tree AS (
              SELECT id, name, manager_id, 0 as level FROM employees WHERE manager_id IS NULL
              UNION ALL
              SELECT e.id, e.name, e.manager_id, et.level + 1 FROM employees e
              JOIN emp_tree et ON e.manager_id = et.id
          )
          SELECT * FROM emp_tree ORDER BY level, name;</code></pre>
        </div>

        <!-- Concept 10: JSONB and Extensions -->
        <div class="panel-v2 concept-section">
          <h5 class="mb-2">10. JSONB and Extensions</h5>
          <div class="explanation">
            <p>JSONB for semi-structured data; operators like @>, ?|. Extensions like pg_trgm for trigram search.</p>
          </div>
          <pre class="code-example"><code>-- JSONB query
          SELECT * FROM users WHERE data @> '{"skills": ["PHP"]}'::JSONB;
          SELECT data->>'skills' as skills FROM users WHERE data ? 'skills';
          
          -- Update JSONB
          UPDATE users SET data = data || '{"level": "senior"}'::JSONB WHERE id = 1;
          
          -- Extension
          CREATE EXTENSION IF NOT EXISTS pg_trgm;
          
          -- Trigram search
          SELECT title FROM posts WHERE title ILIKE '%PHP%' ORDER BY title <-> 'PHP' LIMIT 5;</code></pre>
        </div>

        <div class="alert alert-info mt-4">
          <p>This covers core PostgreSQL concepts. For advanced topics like partitioning, replication, or PL/pgSQL,
            refer to the official docs. Use EXPLAIN ANALYZE for optimization; vacuum regularly for maintenance.</p>
        </div>
      </div>
    </div>
  </main>
  <footer class="py-4 small text-center text-muted-2">
    <div class="container">© <span id="year"></span> Sujeet Yadav — All rights reserved.</div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../../assets/js/script.js"></script>
  <script src="../../assets/js/smoke.js"></script>
  <script>
    // Inline script to update year (demo)
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>

</html>